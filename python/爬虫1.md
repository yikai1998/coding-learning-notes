## è‡ªåŠ¨æˆªå›¾å‰5é¡µ
```py
import ast
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as ec
import base64
import time
import os
import sys


def create_cookie():
    oopt = Options()
    initial = webdriver.Chrome(options=oopt)  # æ–°å»ºæµè§ˆå™¨å®ä¾‹
    initial.get('https://www.google.com')  # æŒ‡å®šæ˜¯googleæœç´¢
    time.sleep(2)
    _ = input('\n'.join([
        '>> 1. Search anything in the engine',
        '>> 2. If Google Firewall is activated, finish the test. If not, go ahead ğŸ‘‡',
        '>> 3. Do not close the browser',
        '>> 4. Press any key to go on: ',
    ]))
    c = initial.get_cookies()
    with open('temp_cookies.txt', mode='w') as f:
        f.write(str(c))
        print('>> New cookie file has been covered')
    initial.quit()


def browser_screenshots(keyword: str, pages: int = 5):
    opts = Options()
    opts.add_argument('--headless=new')  # Chrome 109+ çš„ æ–°æ— å¤´æ¨¡å¼ï¼Œæ”¯æŒæ•´é¡µæˆªå›¾ã€ä¸ä¼šå¼¹çª—
    opts.add_argument('--window-size=1440,900')
    opts.add_argument('--disable-gpu')
    opts.add_argument('--disable-blink-features=AutomationControlled')
    opts.add_experimental_option('excludeSwitches', ['enable-automation'])
    opts.add_experimental_option('useAutomationExtension', False)

    driver = webdriver.Chrome(options=opts)  # æ–°å»ºæµè§ˆå™¨å®ä¾‹
    wait = WebDriverWait(driver, 20)  # æœ€é•¿ç­‰ 15 ç§’ æ‰¾å…ƒç´ ï¼›æ‰¾ä¸åˆ°å°±æŠ› TimeoutException
    driver.get('https://www.google.com')  # æŒ‡å®šæ˜¯googleæœç´¢

    # å¤–éƒ¨æ³¨å…¥cookieï¼Œé˜²æ­¢è¢«è®¤ä¸ºæ˜¯bot
    with open('temp_cookies.txt') as f:
        cookies = ast.literal_eval(f.read())
    for c in cookies:
        driver.add_cookie(c)

    time.sleep(1)
    q_box = wait.until(ec.element_to_be_clickable((By.NAME, 'q')))  # å…ˆç­‰æœç´¢æ¡†å¯ç‚¹å‡»ï¼Œå†ä¸€æ¬¡æ€§è¾“å…¥å…³é”®è¯ + å›è½¦ï¼Œé¿å… StaleElement
    q_box.send_keys(keyword, Keys.ENTER)

    # æ¯é¡µä¸€å¼ æ•´é¡µé•¿å›¾
    for page in range(1, pages + 1):
        wait.until(lambda d: d.execute_script('return document.readyState') == 'complete')  # ç­‰é¡µé¢å®Œå…¨åŠ è½½
        time.sleep(2)  # é¢å¤–ç»™æ‡’åŠ è½½ä¸€ç‚¹æ—¶é—´
        res = driver.execute_cdp_cmd('Page.captureScreenshot', {
            'format': 'png',
            'captureBeyondViewport': True,  # é€šè¿‡ Chrome DevTools Protocol å‘Šè¯‰æµè§ˆå™¨ ä¸è¦åªæˆªå½“å‰è§†å£ï¼ŒæŠŠæ•´é¡µç”»å¸ƒéƒ½ç»™æˆ‘
        })
        save_path = f'capture_{page}.png'
        with open(save_path, 'wb') as f:
            f.write(base64.b64decode(res['data']))  # CDP è¿”å›çš„æ˜¯ Base64 å­—ç¬¦ä¸²ï¼Œè§£ç åæ‰æ˜¯çœŸæ­£çš„ PNG å­—èŠ‚æµ
        print(f'âœ… Saved: {save_path}')
        # ç¿»é¡µï¼ˆæœ€åä¸€é¡µä¸ç¿»ï¼‰
        if page < pages:
            try:
                next_btn = wait.until(ec.element_to_be_clickable((By.ID, 'pnnext')))
                next_btn.click()
            except Exception:
                print('âš ï¸ Last page')
                break

    driver.quit()  # å…³é—­æµè§ˆå™¨ã€å›æ”¶ä¸´æ—¶æ–‡ä»¶ã€é‡Šæ”¾ç«¯å£
    print('>> Completed')


if __name__ == '__main__':
    # è·å–è„šæœ¬æ‰€åœ¨ç›®å½•å¹¶åˆ‡æ¢å·¥ä½œç›®å½•
    # å½“Pythonç¨‹åºè¢«å·¥å…·å¦‚PyInstallerã€cx_Freezeæˆ–py2exeæ‰“åŒ…æˆå¯æ‰§è¡Œæ–‡ä»¶æ—¶ï¼Œè¿™äº›å·¥å…·ä¼šåœ¨sysæ¨¡å—ä¸­æ·»åŠ ä¸€ä¸ªfrozenå±æ€§ã€‚
    # å¦‚æœç¨‹åºæ˜¯æ™®é€šPythonè„šæœ¬ï¼šsys.frozenä¸å­˜åœ¨ï¼Œè¿”å›é»˜è®¤å€¼False
    if getattr(sys, 'frozen', False):
        # å¦‚æœæ˜¯æ‰“åŒ…åçš„å¯æ‰§è¡Œæ–‡ä»¶
        script_dir = os.path.dirname(sys.executable)
    else:
        # å¦‚æœæ˜¯Pythonè„šæœ¬
        script_dir = os.path.dirname(os.path.abspath(__file__))

    # åˆ‡æ¢å½“å‰å·¥ä½œç›®å½•
    os.chdir(script_dir)
    print(f'>> Current path has set to be: {os.getcwd()}')

    create_cookie()
    kw = input('>> Input the keyword of your public search (Default: 5 pages): ')
    browser_screenshots(keyword=kw)
```

